<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DIY Photobooth - Happy Jaemin Day</title>
  <style>
    @font-face {
      font-family: 'American Typewriter';
      src: url('AmericanTypewriter.ttf') format('truetype');
      font-weight: bold;
    }
    body {
      font-family: 'American Typewriter', sans-serif;
      background: url('BGJMDAY.png') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 50vh;
      padding: 10px;
    }
    .title {
      text-align: center;
      font-family: 'American Typewriter';
      font-size: 12.5em;
      font-weight: bold;
      margin-top: 5px;
      color: #814357;
    }
    .subtitle {
      text-align: center;
      font-size: 2.5em;
      color: #814357;
      margin-top: -40px;
      margin-bottom: 25px;
    }
    .container {
      display: flex;
      align-items: flex-start;
      gap: 15px;
    }
    video {
      background: #f7cfe3;
      width: 871px;
      height: 859px;
      border-radius: 10px;
      transform: scaleX(-1);
      object-fit: contain; /* Shows entire camera frame, may add letterboxing */
      display: block;
    }
    #controls {
      margin-top: 5px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    .button-row {
      display: flex;
      gap: 12px;
      margin-bottom: 10px;
      justify-content: center;
    }
    #photostrip-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      width: 500px;
      height: 1500px;
    }
    #photostrip-container-2 {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      width: 500px;
      height: 1500px;
    }
    #photostripImage {
      width: 500px;
      height: auto;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
    }
    #photostripImage2 {
      width: 500px;
      height: auto;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
    }
    .overlay-photo {
      position: absolute;
      width: 435.5px;
      height: 429.5px;
      z-index: 1;
    }
    #photo1 { left: 33px; top: 38.5px; height: 434px !important; }
    #photo2 { left: 33px; top: 496.5px; }
    #photo3 { left: 33px; top: 949.5px; }
    #photo4 { left: 33px; top: 38.5px; height: 434px !important; }
    #photo5 { left: 33px; top: 496.5px; }
    #photo6 { left: 33px; top: 949.5px; }

    button {
      padding: 15px 30px;
      font-size: 1.875em;
      background-color: #000;
      color: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
    }
    #countdown {
      font-size: 2.5em;
      margin: 5px;
      color: #814357;
    }
    .footer {
      font-size: 1em;
      margin-top: 25px;
      color: #814357;
    }
  </style>
</head>
<body>
  <div class="title">DIY Photobooth</div>
  <div class="subtitle">Happy Jaemin Day</div>
  <div class="container">
    <div>
      <video id="video" autoplay></video>
      <div id="controls">
        <div class="button-row">
          <button onclick="startCapture()">Start to capture Photostrip 1</button>
          <button onclick="downloadPhotostrip()">Download Photostrip 1</button>
        </div>
        <div class="button-row">
          <button onclick="startCapture2()">Start to capture Photostrip 2</button>
          <button onclick="downloadPhotostrip2()">Download Photostrip 2</button>
        </div>
        <div id="countdown"></div>
      </div>
    </div>
    <div id="photostrip-container">
      <canvas class="overlay-photo" id="photo1"></canvas>
      <canvas class="overlay-photo" id="photo2"></canvas>
      <canvas class="overlay-photo" id="photo3"></canvas>
      <img id="photostripImage" src="JaeminDay.png" alt="Photostrip layout" />
    </div>
    <div id="photostrip-container-2" style="position: relative; width: 500px; height: 1500px;">
      <canvas class="overlay-photo" id="photo4"></canvas>
      <canvas class="overlay-photo" id="photo5"></canvas>
      <canvas class="overlay-photo" id="photo6"></canvas>
      <img id="photostripImage2" src="JaeminDay2.png" alt="Photostrip layout 2" style="position: absolute; top: 0; left: 0; width: 500px; height: auto; z-index: 2;" />
    </div>
  </div>
  <canvas id="finalImage" style="display:none;"></canvas>
  <canvas id="finalImage2" style="display:none;"></canvas>
  <div class="footer">Â© flappinghyuck | Sweet Pages For Jaemin</div>

<script>
   // Camera preview setup
  const video = document.getElementById('video');
  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(function(stream) {
        video.srcObject = stream;
        video.play();
      })
      .catch(function(err) {
        alert('Could not access the camera: ' + err);
      });
  } else {
    alert('getUserMedia is not supported in this browser.');
  }
let captureIndex = 0;
const photoCanvases = [
  document.getElementById('photo1'),
  document.getElementById('photo2'),
  document.getElementById('photo3')
];
const countdownDiv = document.getElementById('countdown');

// Halved canvas dimensions
const canvasW = 435.5;
const canvasH = 429.5;

function startCapture() {
  captureIndex = 0;
  captureNextPhoto();
}
function captureNextPhoto() {
  if (captureIndex >= photoCanvases.length) {
    countdownDiv.textContent = "Done!";
    return;
  }
  let countdown = 3;
  countdownDiv.textContent = countdown;
  const interval = setInterval(() => {
    countdown--;
    if (countdown > 0) {
      countdownDiv.textContent = countdown;
    } else {
      clearInterval(interval);
      countdownDiv.textContent = "";
      // Capture photo (MIRRORED)
      const ctx = photoCanvases[captureIndex].getContext('2d');
      photoCanvases[captureIndex].width = canvasW;
      photoCanvases[captureIndex].height = canvasH;
      ctx.save();
      ctx.translate(canvasW, 0);
      ctx.scale(-1, 1);
      ctx.drawImage(video, 0, 0, canvasW, canvasH);
      ctx.restore();
      captureIndex++;
      setTimeout(captureNextPhoto, 500); // Short pause before next photo
    }
  }, 1000);
}
  function downloadPhotostrip() {
    const finalCanvas = document.getElementById('finalImage');
    const ctx = finalCanvas.getContext('2d');

    finalCanvas.width = 500;
    finalCanvas.height = 1500;

    const photo1 = document.getElementById('photo1');
    const photo2 = document.getElementById('photo2');
    const photo3 = document.getElementById('photo3');

    ctx.drawImage(photo1, 33, 38.5);
    ctx.drawImage(photo2, 33, 496.5);
    ctx.drawImage(photo3, 33, 949.5);

    const bgImage = new Image();
    bgImage.crossOrigin = 'anonymous';
    bgImage.onload = function () {
      ctx.drawImage(bgImage, 0, 0, 500, 1500);

      const link = document.createElement('a');
      link.download = 'JaeminDay_Photostrip.png';
      link.href = finalCanvas.toDataURL('image/png');
      link.click();
    };
    const strip = document.getElementById('photostripImage');
    bgImage.src = strip.src;
  }
  let captureIndex2 = 0;
const photoCanvases2 = [
  document.getElementById('photo4'),
  document.getElementById('photo5'),
  document.getElementById('photo6')
];

function startCapture2() {
  captureIndex2 = 0;
  captureNextPhoto2();
}
function captureNextPhoto2() {
  if (captureIndex2 >= photoCanvases2.length) {
    countdownDiv.textContent = "Done!";
    return;
  }
  let countdown = 3;
  countdownDiv.textContent = countdown;
  const interval = setInterval(() => {
    countdown--;
    if (countdown > 0) {
      countdownDiv.textContent = countdown;
    } else {
      clearInterval(interval);
      countdownDiv.textContent = "";
      // Set canvas size
      photoCanvases2[captureIndex2].width = canvasW;
      photoCanvases2[captureIndex2].height = canvasH;
      const ctx = photoCanvases2[captureIndex2].getContext('2d');
      ctx.save();
      ctx.translate(canvasW, 0);
      ctx.scale(-1, 1);
      ctx.clearRect(0, 0, canvasW, canvasH);
      ctx.drawImage(video, 0, 0, canvasW, canvasH);
      ctx.restore();
      // Move canvas to correct position
      if (captureIndex2 === 0) {
        photoCanvases2[captureIndex2].style.left = "33px";
        photoCanvases2[captureIndex2].style.top = "38.5px";
      } else if (captureIndex2 === 1) {
        photoCanvases2[captureIndex2].style.left = "33px";
        photoCanvases2[captureIndex2].style.top = "496.5px";
      } else if (captureIndex2 === 2) {
        photoCanvases2[captureIndex2].style.left = "33px";
        photoCanvases2[captureIndex2].style.top = "949.5px";
      }
      captureIndex2++;
      setTimeout(captureNextPhoto2, 500); // Short pause before next photo
    }
  }, 1000);
}
  function downloadPhotostrip2() {
  const finalCanvas = document.getElementById('finalImage2');
  const ctx = finalCanvas.getContext('2d');

  finalCanvas.width = 500;
  finalCanvas.height = 1500;

  const bgImage = new Image();
  bgImage.crossOrigin = 'anonymous';
  bgImage.onload = function () {
    ctx.drawImage(bgImage, 0, 0, 500, 1500);

    const photo4 = document.getElementById('photo4');
    const photo5 = document.getElementById('photo5');
    const photo6 = document.getElementById('photo6');

    ctx.drawImage(photo4, 33, 38.5);
    ctx.drawImage(photo5, 33, 496.5);
    ctx.drawImage(photo6, 33, 949.5);

    const link = document.createElement('a');
    link.download = 'JaeminDay_Photostrip2.png';
    link.href = finalCanvas.toDataURL('image/png');
    link.click();
  };
  const strip = document.getElementById('photostripImage2');
  bgImage.src = strip.src;
}
</script>
</body>
</html>